#!/usr/bin/env sh

# Get the root directory of the git repository
REPO_ROOT=$(git rev-parse --show-toplevel)

echo "ğŸ§ª Running backend tests before commit..."

# Change to backend directory and run tests
cd "$REPO_ROOT/backend" && npm test

if [ $? -ne 0 ]; then
  echo "âŒ Tests failed! Commit aborted."
  echo "ğŸ’¡ If you're seeing '@jest/test-sequencer' error due to macOS sandbox:"
  echo "   Run: git commit --no-verify"
  echo "   CI will test properly on GitHub Actions."
  exit 1
fi

echo "âœ… All tests passed! Proceeding with commit..."
